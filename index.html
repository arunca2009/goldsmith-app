<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Goldsmith Billing</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
 font-family: Arial, sans-serif;
 background:#f2f2f2;
 padding:10px;
}
.box{
 background:#fff;
 padding:15px;
 border-radius:12px;
 max-width:520px;
 margin:auto;
}
input,select,button{
 width:100%;
 padding:12px;
 margin-top:8px;
 font-size:16px;
 border-radius:8px;
 border:1px solid #ccc;
}
button{
 background:#0a7cff;
 color:white;
 border:none;
}
h2{text-align:center;}
.section{
 background:#f7f7f7;
 padding:10px;
 border-radius:8px;
 margin-top:10px;
}
</style>
</head>

<body>

<script>
if(prompt("Enter Password")!="1234"){
 document.body.innerHTML="ACCESS DENIED";
}
</script>

<div class="box">

<h2>SRI MARUTHAMALAI JEWELS WORKS</h2>

<div class="section">
<input id="name" placeholder="Customer Name">
<input id="phone" placeholder="Phone Number">
</div>

<div class="section">
<select id="item">
<option>Ring</option>
<option>Necklace</option>
<option>Bangle</option>
<option>Chain</option>
</select>

<select id="purity">
<option>22K</option>
<option>18K</option>
</select>

<input id="weight" placeholder="New Gold Weight (g)">
<input id="rate" placeholder="Gold Rate per gram">
<input id="making" placeholder="Making Charge">
<input id="stone" placeholder="Stone Charge">
<input id="hallmark" placeholder="Hallmark Charge">
<input id="advance" placeholder="Advance Paid">
</div>

<div class="section">
<select id="oldGiven" onchange="toggleOldGold()">
<option value="no">Old Gold Given? - NO</option>
<option value="yes">Old Gold Given? - YES</option>
</select>
</div>

<div class="section" id="oldSection" style="display:none;">
<h3>Old Gold Exchange</h3>

<select id="oldTouch">
<option value="91.6">22K</option>
<option value="75">18K</option>
<option value="100">24K</option>
</select>

<input id="oldWeight" placeholder="Old Gold Weight (g)">
<input id="oldRate" placeholder="Old Gold Rate">
</div>

<button onclick="calculate()">CALCULATE</button>

<h3 id="result">Final Payable: Rs. 0</h3>
<h3 id="balance">Balance: Rs. 0</h3>

<button onclick="saveOrder()">SAVE ORDER</button>
<button onclick="shareInvoice()">SHARE INVOICE</button>
<button onclick="generatePDF()">DOWNLOAD PDF</button>

</div>

<script>

/* TOGGLE OLD GOLD */
function toggleOldGold(){
 let v=document.getElementById("oldGiven").value;
 document.getElementById("oldSection").style.display=
 (v=="yes")?"block":"none";

 if(v=="no"){
  oldWeight.value=0;
  oldRate.value=0;
 }
}

/* CALCULATE */
function calculate(){

 let w=Number(weight.value);
 let r=Number(rate.value);
 let m=Number(making.value);
 let s=Number(stone.value);
 let h=Number(hallmark.value);
 let adv=Number(advance.value);

 let ow=Number(oldWeight.value);
 let ot=Number(oldTouch.value);
 let orate=Number(oldRate.value);

 let newTotal=(w*r)+m+s+h;

 let pure=ow*(ot/100);
 let oldValue=pure*orate;

 let final=newTotal-oldValue;
 if(final<0) final=0;

 let bal=final-adv;
 if(bal<0) bal=0;

 result.innerText="Final Payable: Rs. "+final.toFixed(2);
 balance.innerText="Balance: Rs. "+bal.toFixed(2);
}

/* SAVE */
function saveOrder(){

 let url="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"+
 "?name="+name.value+
 "&phone="+phone.value+
 "&item="+item.value+
 "&purity="+purity.value+
 "&weight="+weight.value+
 "&rate="+rate.value+
 "&making="+making.value+
 "&stone="+stone.value+
 "&hallmark="+hallmark.value+
 "&oldweight="+oldWeight.value+
 "&oldtouch="+oldTouch.options[oldTouch.selectedIndex].text+
 "&oldrate="+oldRate.value+
 "&final="+result.innerText+
 "&advance="+advance.value+
 "&balance="+balance.innerText;

 window.open(url);
 alert("Saved");
}

/* SHARE */
function shareInvoice(){
 let msg=
"SRI MARUTHAMALAI JEWELS WORKS\n"+
result.innerText+"\n"+
balance.innerText;
 window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

/* PDF */
function generatePDF(){

 if(!window.jspdf){
  alert("Internet needed first time");
  return;
 }

 const {jsPDF}=window.jspdf;
 const doc=new jsPDF();

 doc.setFontSize(16);
 doc.text("SRI MARUTHAMALAI JEWELS WORKS",20,20);
 doc.text("INVOICE",90,30);

 doc.setFontSize(11);
 doc.text("Customer: "+name.value,20,45);
 doc.text("Phone: "+phone.value,20,53);

 doc.text(result.innerText,20,70);
 doc.text(balance.innerText,20,80);

 doc.save("Invoice.pdf");
}

</script>

</body>
</html>
